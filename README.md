# CloudDisk 云盘系统

一个基于Qt开发的轻量级云盘系统，支持文件上传、下载、分享、回收站等功能。

## 📋 项目简介

CloudDisk是一个C/S架构的云盘系统，采用Qt框架开发，提供直观的图形用户界面。系统支持多用户管理，每个用户拥有独立的存储空间，具备完整的文件管理功能。

## ✨ 主要功能

### 🔐 用户管理
- **用户注册**：支持新用户注册，用户名唯一性验证
- **用户登录**：安全的密码验证机制，使用MD5加密
- **账户设置**：支持修改用户名和密码

### 📁 文件管理
- **文件上传**：支持任意类型文件上传到云端
- **文件下载**：支持单文件或多文件批量下载
- **文件删除**：支持文件删除到回收站
- **文件恢复**：从回收站恢复已删除文件
- **彻底删除**：永久删除回收站中的文件

### 🔗 文件分享
- **生成分享链接**：为文件生成唯一的分享链接和访问密码
- **分享文件下载**：通过链接和密码下载他人分享的文件
- **分享记录管理**：查看和管理分享历史

### 📊 操作记录
- **操作日志**：记录所有文件操作（上传、下载、删除等）
- **日志查看**：查看详细的操作历史记录

### 🗂️ 回收站
- **删除保护**：删除的文件自动移至回收站
- **文件恢复**：支持从回收站恢复文件
- **彻底清理**：支持永久删除回收站文件

## 🛠️ 技术栈

### 客户端 (Client)
- **Qt 5/6**：跨平台GUI框架
- **Qt Network**：网络通信模块
- **Qt Widgets**：用户界面组件
- **C++11**：编程语言

### 服务器端 (Server)
- **Qt Core**：核心功能模块
- **Qt Network**：TCP服务器
- **Qt SQL**：数据库操作
- **SQLite**：轻量级数据库
- **C++11**：编程语言

## 📁 项目结构

```
CloudDisk/
├── client/                 # 客户端代码
│   ├── CloudDiskClient.pro # 客户端项目文件
│   ├── main.cpp           # 主程序入口
│   ├── formlogin.h/cpp    # 登录界面
│   ├── mainwindow.h/cpp   # 主界面
│   ├── res/               # 资源文件
│   └── debug/             # 编译输出
├── server/                # 服务器端代码
│   ├── CloudDiskServer.pro # 服务器项目文件
│   ├── main.cpp           # 服务器入口
│   ├── mainserver.h       # 服务器主类
│   ├── db.h               # 数据库操作类
│   ├── protocol.h         # 通信协议定义
│   ├── database.db        # SQLite数据库文件
│   └── data/              # 用户文件存储目录
└── download/              # 客户端下载目录
```

## 🚀 快速开始

### 环境要求
- Qt 5.12+ 或 Qt 6.0+
- C++11 兼容的编译器
- Windows/Linux/macOS

### 编译步骤

#### 1. 编译服务器端
```bash
cd server
qmake CloudDiskServer.pro
make
```

#### 2. 编译客户端
```bash
cd client
qmake CloudDiskClient.pro
make
```

### 运行步骤

#### 1. 启动服务器
```bash
cd server
./CloudDiskServer
```

#### 2. 启动客户端
```bash
cd client
./CloudDiskClient
```

## ⚙️ 配置说明

### 服务器配置
- 默认端口：8899
- 数据库：SQLite (database.db)
- 文件存储：./data/ 目录

### 客户端配置
- 服务器地址：127.0.0.1
- 下载目录：./download/

## 🔧 开发说明

### 通信协议
系统使用自定义的Msg结构体进行通信：

```cpp
struct Msg {
    char type[16];      // 消息类型
    char msg1[64];      // 字段1
    char msg2[64];      // 字段2
    char content[164];  // 消息主体
    char user[16];      // 用户ID
    int fileSize;       // 文件大小
};
```

### 支持的消息类型
- `LOGIN`：用户登录
- `REG`：用户注册
- `UP`：文件上传
- `DOWN`：文件下载
- `DEL`：文件删除
- `RECOVER`：文件恢复
- `SHARE`：文件分享
- `LIST`：获取文件列表
- `RECYCLE`：获取回收站列表
- `LOG`：获取操作记录

## 📝 许可证

本项目采用 MIT 许可证，详见 [LICENSE](LICENSE) 文件。

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request 来改进这个项目。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 Issue
- 发送邮件

---

**注意**：这是一个学习项目，不建议用于生产环境。在生产环境中使用时，请确保添加适当的安全措施。 